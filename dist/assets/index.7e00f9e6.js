import{r as e,o as t,c as o,a as l,d as a,u as n,b as s,e as c,w as i,f as r,g as u,h as d,t as m,F as p,m as f,i as g,j as v,k as y,E as w,l as b,n as h,p as k,q as _,s as $,_ as C,v as x,x as j,y as V,z as S,A as T,B as P,C as O,D as z}from"./vendor.4effabb1.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const U={},N={id:"root"};U.render=function(a,n){const s=e("router-view");return t(),o("div",N,[l(s)])};const E="https://service-8ca882p4-1257689370.gz.apigw.tencentcs.com",I="/users",D="/article",M="/comment";async function K(e,t="GET",o={},l=""){if("GET"==t){return(await fetch(`${e}`,{method:t,mode:"cors",cache:"no-cache",headers:{token:l,"Content-Type":"application/x-www-form-urlencoded"}})).json()}var a=new URLSearchParams;for(let n in o)a.append(n,o[n]);return(await fetch(`${e}`,{method:t,mode:"cors",cache:"no-cache",headers:{token:l,"Content-Type":"application/x-www-form-urlencoded"},body:a})).json()}const Y=async function(e){let t=await K(`${E}${I}/verify`,"POST",{},e);return"object"!=typeof t?(console.log(t),"服务端错误"):500==t.code?(console.log(t),t.msg):t},A=async function(e,t){let o=await K(`${E}${I}/login`,"POST",{username:e,password:t});return"object"!=typeof o?(console.log(o),"服务端错误"):500==o.code?(console.log(o),o.msg):o},B=async function(){let e=await K(`${E}${I}`);return"object"!=typeof e?(console.log(e),"服务端错误"):500==e.code?(console.log(e),e.msg):e},L=async function(){let e=await K(`${E}${D}`);return"object"!=typeof e?(console.log(e),"服务端错误"):500==e.code?e.msg:e},R=async function(e,t,o){let l=await K(`${E}${D}`,"POST",{title:e,content:t},o);return"object"!=typeof l?(console.log(l),"服务端错误"):500==l.code?l.msg:l},q=async function(e,t){let o=await K(`${E}${D}/id/${e}`,"DELETE",{},t);return"object"!=typeof o?(console.log(o),"服务端错误"):500==o.code?o.msg:o},F=async function(e,t){let o=await K(`${E}${D}/recive`,"POST",{id:e},t);return"object"!=typeof o?(console.log(o),"服务端错误"):500==o.code?o.code:o},X=async function(){let e=await K(`${E}${M}`);return"object"!=typeof e?(console.log(e),"服务端错误"):500==e.code?e.code:e},G=async function(e,t,o){let l=await K(`${E}${M}`,"POST",{aid:e,content:t},o);return"object"!=typeof l?(console.log(l),"服务端错误"):500==l.code?l.msg:l},H=async function(e,t){let o=await K(`${E}${M}/id/${e}`,"DELETE",{},t);return"object"!=typeof o?(console.log(o),"服务端错误"):500==o.code?o.msg:o},Z=y("登 录"),J={class:"header"},Q=y("收起"),W=y("展开"),ee={key:1,class:"userinfo"},te={class:"ava"},oe=["src"],le={class:"nickname"},ae=r("div",{class:"logout"}," 退出登录 ",-1),ne=y("工作报告"),se=y("文档共享"),ce=y("日历");var ie=a({props:{now:String},setup(a){const y=n(),b=s(!1),h=(e,t)=>{console.log(e,t)},k=(e,t)=>{console.log(e,t)},_=e=>{console.log(e),y.commit("changeCollspace",e),console.log(y.state.collspace)},$=c({name:"",password:""}),C=s(!1),x=s(c({ava:"",nickname:"",username:""}));(async()=>{let e=await Y(y.state.token);C.value="object"==typeof e,console.log(e),y.commit("setUid",e.id),x.value=c({ava:e.avaurl,nickname:e.nickname,username:e.username}),console.log(x)})();const j=async()=>{if($.name.length<1||$.password.length<1)return void w.error("请填写完整的用户名和密码");console.log(`开始尝试登陆username:${$.name},password:${$.password}`);let e=await A($.name,$.password);var t;"object"==typeof e?(t=e.msg,w({message:t,type:"success"}),y.commit("setToken",e.token),setTimeout((function(){b.value=!1}),500),setTimeout((()=>{location.reload()}),800)):w.error(e)};return(n,s)=>{const c=e("el-input"),w=e("el-form-item"),V=e("el-button"),S=e("el-form"),T=e("el-dialog"),P=e("el-radio-button"),O=e("el-radio-group"),z=e("el-popconfirm"),U=e("el-icon"),N=e("el-menu-item"),E=e("router-link"),I=e("el-menu");return t(),o(p,null,[l(T,{modelValue:b.value,"onUpdate:modelValue":s[3]||(s[3]=e=>b.value=e),title:"登 陆",center:!0,width:"40%"},{default:i((()=>[l(S,{"label-position":"top","label-width":"25vw",model:u($)},{default:i((()=>[l(w,{label:"用户名"},{default:i((()=>[l(c,{modelValue:u($).name,"onUpdate:modelValue":s[0]||(s[0]=e=>u($).name=e)},null,8,["modelValue"])])),_:1}),l(w,{label:"密码"},{default:i((()=>[l(c,{type:"password",modelValue:u($).password,"onUpdate:modelValue":s[1]||(s[1]=e=>u($).password=e)},null,8,["modelValue"])])),_:1}),l(w,null,{default:i((()=>[l(V,{type:"primary",class:"submit",onClick:s[2]||(s[2]=e=>j())},{default:i((()=>[Z])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),r("div",J,[l(O,{class:"group",modelValue:u(y).state.collspace,"onUpdate:modelValue":s[6]||(s[6]=e=>u(y).state.collspace=e),style:{"margin-bottom":"20px"}},{default:i((()=>[l(P,{label:!0,onClick:s[4]||(s[4]=e=>_(!0))},{default:i((()=>[Q])),_:1}),l(P,{label:!1,onClick:s[5]||(s[5]=e=>_(!1))},{default:i((()=>[W])),_:1})])),_:1},8,["modelValue"]),C.value?d("",!0):(t(),o("div",{key:0,class:"login",onClick:s[7]||(s[7]=e=>b.value=!0)}," 登 录 ")),C.value?(t(),o("div",ee,[r("div",te,[r("img",{src:x.value.ava},null,8,oe)]),r("div",le,m(x.value.nickname),1),l(z,{"confirm-button-text":"Yes","cancel-button-text":"No",icon:n.InfoFilled,"icon-color":"red",title:"是否确定退出",onConfirm:s[8]||(s[8]=e=>(async()=>{y.commit("setToken",""),y.commit("setUid",-1),location.reload()})())},{reference:i((()=>[ae])),_:1},8,["icon"])])):d("",!0)]),l(I,{"default-active":a.now,class:"el-menu",collapse:u(y).state.collspace,onOpen:h,onClose:k},{default:i((()=>[l(E,{to:"/"},{default:i((()=>[l(N,{index:"1"},{title:i((()=>[ne])),default:i((()=>[l(U,null,{default:i((()=>[l(u(f))])),_:1})])),_:1})])),_:1}),l(E,{to:"/share"},{default:i((()=>[l(N,{index:"2"},{title:i((()=>[se])),default:i((()=>[l(U,null,{default:i((()=>[l(u(g))])),_:1})])),_:1})])),_:1}),l(E,{to:"/setting"},{default:i((()=>[l(N,{index:"3"},{title:i((()=>[ce])),default:i((()=>[l(U,null,{default:i((()=>[l(u(v))])),_:1})])),_:1})])),_:1})])),_:1},8,["default-active","collapse"])],64)}}});function re(e){return e<10?"0"+e:e}let ue={format:function(e){var t=(e=new Date(e)).getFullYear(),o=e.getMonth()+1,l=e.getDate(),a=e.getHours(),n=e.getMinutes(),s=e.getSeconds();return t+"-"+re(o)+"-"+re(l)+" "+re(a)+":"+re(n)+":"+re(s)}};const de=y("发表工作汇报"),me={class:"container"},pe={class:"right"},fe={key:0,class:"post"},ge=y("发表工作汇报"),ve={class:"show"},ye={class:"card-header"},we={key:0,class:"delete"},be=y(" 删除 "),he={class:"content"},ke={class:"footer"},_e={key:0,class:"recive"},$e=y("收到"),Ce={key:1,class:"tips"},xe=["src"],je={key:0},Ve=r("span",null," 已收到 ",-1),Se={key:2,class:"tips"},Te={class:"name"},Pe={class:"time"},Oe={key:1,class:"comment"},ze=r("div",{class:"comment_title"}," 评论区 ",-1),Ue={class:"post_comment"},Ne=y("发表"),Ee={key:0,class:"no_comment"},Ie={key:1,class:"comment_content"},De={class:"each_comment"},Me=["src"],Ke={class:"tips"},Ye={class:"del"},Ae=y("删除");var Be=a({setup(a){const f=n(),g=s(c([])),v=s(c({})),j=s(c([])),V=s(!0),S=s(!1),T=c({title:"",content:""}),P=s(""),O=async function(){await async function(){let e=await B(),t=[];for(let o of e)t[`${o.id}`]=o;v.value=t,console.log(v)}();let e=await L();"object"==typeof e?(e.reverse(),console.log(f.state.uid),g.value=e):w.error(e)},z=async function(){await O();let e=await X();if("object"!=typeof e)return void w.error(e);let t={};console.log(e);for(let o=e.length-1;o>=0;o--)t.hasOwnProperty(e[o].aid.toString())||(t[e[o].aid.toString()]=[],console.log(`${e[o].aid}需要构建`)),t[e[o].aid.toString()].push(e[o]);j.value=t,V.value=!1};z();return(a,n)=>{const s=e("el-input"),c=e("el-form-item"),U=e("el-button"),N=e("el-form"),E=e("el-dialog"),I=e("el-popconfirm"),D=e("el-card"),M=e("el-backtop"),K=b("loading");return t(),o(p,null,[l(E,{modelValue:S.value,"onUpdate:modelValue":n[3]||(n[3]=e=>S.value=e),title:"发表工作汇报",center:!0,width:"40%"},{default:i((()=>[l(N,{"label-position":"top","label-width":"25vw",model:u(T)},{default:i((()=>[l(c,{label:"标 题"},{default:i((()=>[l(s,{modelValue:u(T).title,"onUpdate:modelValue":n[0]||(n[0]=e=>u(T).title=e)},null,8,["modelValue"])])),_:1}),l(c,{label:"内 容"},{default:i((()=>[l(s,{type:"textarea",modelValue:u(T).content,"onUpdate:modelValue":n[1]||(n[1]=e=>u(T).content=e)},null,8,["modelValue"])])),_:1}),l(c,null,{default:i((()=>[l(U,{type:"primary",class:"submit",onClick:n[2]||(n[2]=e=>async function(){let e=await R(T.title,T.content,f.state.token);if("object"!=typeof e)return void w.error(e);w({message:e.msg,type:"success"}),T.value={title:"",content:""},O(),setTimeout((()=>{S.value=!1}),800)}())},{default:i((()=>[de])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),r("div",me,[l(ie,{now:"1"}),r("div",pe,[u(f).state.hasOwnProperty("uid")&&u(f).state.uid>=1?(t(),o("div",fe,[l(U,{class:"postArticle",type:"primary",onClick:n[4]||(n[4]=e=>S.value=!0),icon:u(h)},{default:i((()=>[ge])),_:1},8,["icon"])])):d("",!0),k(r("div",ve,[(t(!0),o(p,null,_(g.value,((e,a)=>(t(),$(D,{key:a,class:"box-card",shadow:"hover"},{header:i((()=>[r("div",ye,[r("span",null,m(e.title),1),u(f).state.hasOwnProperty("uid")&&u(f).state.uid==e.uid?(t(),o("span",we,[l(I,{"confirm-button-text":"Yes","cancel-button-text":"No",icon:u(x),"icon-color":"red",title:"是否确认删除?",onConfirm:t=>async function(e){let t=await q(e,f.state.token);"object"==typeof t?(O(),w({message:t.msg,type:"success"})):w.error(t)}(e.id)},{reference:i((()=>[l(U,{type:"danger",icon:u(C)},{default:i((()=>[be])),_:1},8,["icon"])])),_:2},1032,["icon","onConfirm"])])):d("",!0)])])),default:i((()=>[r("div",he,[r("pre",null,m(e.content),1)]),r("div",ke,[u(f).state.hasOwnProperty("uid")&&u(f).state.uid>=1?(t(),o("div",_e,[e.recive.split(",").indexOf(u(f).state.uid.toString())<0?(t(),$(I,{key:0,"confirm-button-text":"Yes","cancel-button-text":"No",icon:u(x),"icon-color":"red",title:"是否确认收到?",onConfirm:t=>async function(e){let t=await F(e,f.state.token);if("object"!=typeof t)return 500==t?void w.error("重复收到"):void w.error(t);await O(),w({message:t.msg,type:"success"})}(e.id)},{reference:i((()=>[l(U,{class:"recive_button",type:"primary"},{default:i((()=>[$e])),_:1})])),_:2},1032,["icon","onConfirm"])):d("",!0),null!=e.recive?(t(),o("div",Ce,[(t(!0),o(p,null,_(e.recive.split(",").filter((e=>""!=e)),((l,a)=>(t(),o("span",null,[r("img",{src:v.value[`${l}`].avaurl},null,8,xe),y(" "+m(v.value[`${l}`].nickname),1),a!=e.recive.split(",").filter((e=>""!=e)).length-1?(t(),o("span",je,"、")):d("",!0)])))),256)),Ve])):d("",!0),null==e.recive?(t(),o("div",Se," 暂无人收到 ")):d("",!0)])):d("",!0),r("div",Te,m(v.value[`${e.uid}`].nickname),1),r("div",Pe,m(u(ue).format(1e3*e.time)),1),u(f).state.hasOwnProperty("uid")&&u(f).state.uid>=1?(t(),o("div",Oe,[ze,r("div",Ue,[l(s,{modelValue:P.value,"onUpdate:modelValue":n[5]||(n[5]=e=>P.value=e),autosize:"",type:"textarea",placeholder:"输入你的评论",style:{display:"block"}},null,8,["modelValue"]),l(U,{class:"submit_button",type:"primary",onClick:t=>(async e=>{let t=await G(e,P.value,f.state.token);"object"==typeof t?(await z(),P.value="",await z(),w({message:t.msg,type:"success"})):w.error(t)})(`${e.id}`)},{default:i((()=>[Ne])),_:2},1032,["onClick"])]),j.value.hasOwnProperty(`${e.id}`)?(t(),o("div",Ie,[(t(!0),o(p,null,_(j.value[`${e.id}`],((e,a)=>(t(),o("div",De,[r("img",{src:v.value[`${e.uid}`].avaurl},null,8,Me),y(m(v.value[`${e.uid}`].nickname)+" 说 ："+m(e.content)+" ",1),r("div",Ke,m(u(ue).format(1e3*e.time)),1),r("div",Ye,[e.uid==u(f).state.uid?(t(),$(I,{key:0,"confirm-button-text":"Yes","cancel-button-text":"No",icon:u(x),"icon-color":"red",title:"确认删除评论吗?",onConfirm:t=>async function(e){let t=await H(e,f.state.token);"object"==typeof t?(await z(),w({message:t.msg,type:"success"})):w.error(t)}(`${e.id}`)},{reference:i((()=>[l(U,{class:"del_button",type:"warning"},{default:i((()=>[Ae])),_:1})])),_:2},1032,["icon","onConfirm"])):d("",!0)])])))),256))])):(t(),o("div",Ee," 暂时没有评论 "))])):d("",!0)])])),_:2},1024)))),128))],512),[[K,V.value]]),l(M)])])],64)}}});const Le={class:"container"},Re={class:"right"},qe={class:"show"},Fe=r("span",null,"Custom header content",-1),Xe=y("Previous Year"),Ge=y("Previous Month"),He=y("Today"),Ze=y("Next Month"),Je=y("Next Year");var Qe=a({setup(a){const n=s(),c=e=>{n.value.selectDate(e)};return(a,s)=>{const u=e("el-button"),d=e("el-button-group"),p=e("el-calendar");return t(),o("div",Le,[l(ie,{now:"3"}),r("div",Re,[r("div",qe,[l(p,{ref:(e,t)=>{t.calendar=e,n.value=e}},{header:i((({date:e})=>[Fe,r("span",null,m(e),1),l(d,null,{default:i((()=>[l(u,{size:"small",onClick:s[0]||(s[0]=e=>c("prev-year"))},{default:i((()=>[Xe])),_:1}),l(u,{size:"small",onClick:s[1]||(s[1]=e=>c("prev-month"))},{default:i((()=>[Ge])),_:1}),l(u,{size:"small",onClick:s[2]||(s[2]=e=>c("today"))},{default:i((()=>[He])),_:1}),l(u,{size:"small",onClick:s[3]||(s[3]=e=>c("next-month"))},{default:i((()=>[Ze])),_:1}),l(u,{size:"small",onClick:s[4]||(s[4]=e=>c("next-year"))},{default:i((()=>[Je])),_:1})])),_:1})])),_:1},512)])])])}}});const We={class:"container"},et={key:0,class:"right"},tt={class:"upload"},ot={class:"upload_button"},lt=y("选择文件 "),at=y("上传 "),nt={class:"uploadtips"},st={class:"tips"},ct={class:"speed"},it={key:0,class:"show"},rt={class:"file_card"},ut=r("img",{src:"https://arcsoft.dadiqq.cn/file.jpg",class:"image"},null,-1),dt={style:{padding:"14px"}},mt={class:"filename"},pt={class:"bottom"},ft={class:"size"},gt=y("下载"),vt={key:1,class:"noshow"},yt={key:1,class:"permission"},wt=[r("p",null,"对不起您无权访问该页面",-1),r("p",null,"请先登录",-1)];const bt=[{path:"/",component:Be},{path:"/home",component:Be},{path:"/share",component:a({setup(a){const c=n(),d=new j({SecretId:"AKIDf8NMAnDPM4XmmX3KM9l37wXu3w852nKd",SecretKey:"69xYjfNr78vTw1rTqyrVu4yc2ECvObZH"}),f=s(""),g=s(0),v=s("0 kb/s "),y=s(),b=async e=>{f.value=e.name,g.value=0;let t=31457280;if(console.log(e),e.size>=t)return console.log("too big"),w.error(`${e.name}太大，上传大小限制为30MB`),!1;console.log("开始上传");let o=await(e=>new Promise(((t,o)=>{d.putObject({Bucket:"pan-1257689370",Region:"ap-guangzhou",Key:e.name,StorageClass:"STANDARD",Body:e,onProgress:function(e){g.value=100*e.percent,v.value=e.speed/1024+" kb/s "}},(function(e,l){!e||null==e&&null==e?t(l):o(e)}))})))(e);return console.log(o),!1},h=s([]),k=async()=>{try{let e=await new Promise(((e,t)=>{d.getBucket({Bucket:"pan-1257689370",Region:"ap-guangzhou"},(function(o,l){!o||null==o&&null==o?e(l):t(o)}))}));console.log(e),h.value=e.Contents}catch(e){console.log(e),w.error("列出文件出现未知错误")}};k();const $=function(e,t){void 0!==t&&0==t.length&&k()},C=async function(e){try{let o=await(t=e,new Promise(((e,o)=>{d.getObjectUrl({Bucket:"pan-1257689370",Region:"ap-guangzhou",Key:t},(function(t,l){!t||null==t&&null==t?e(l):o(t)}))})));console.log(o),w({type:"success",message:"请求下载成功"}),window.open(o.Url,"_blank")}catch(o){w.error("请求下载失败")}var t};return(a,n)=>{const s=e("el-icon"),d=e("el-button"),w=e("el-upload"),k=e("el-progress"),x=e("el-card");return t(),o("div",We,[l(ie,{now:"2"}),void 0!==u(c).state.uid&&u(c).state.uid>0?(t(),o("div",et,[r("div",tt,[r("div",ot,[l(w,{ref:(e,t)=>{t.uploadRef=e,y.value=e},class:"upload-demo","auto-upload":!1,multiple:!0,action:"","before-upload":b,"on-change":$},{trigger:i((()=>[l(d,{type:"primary",class:"button"},{default:i((()=>[l(s,{class:"icon"},{default:i((()=>[l(u(V))])),_:1}),lt])),_:1})])),default:i((()=>[l(d,{type:"success",class:"button",onClick:n[0]||(n[0]=e=>{y.value.submit()})},{default:i((()=>[l(s,{class:"icon"},{default:i((()=>[l(u(V))])),_:1}),at])),_:1})])),_:1},512)]),r("div",nt,[r("span",st," 正在上传："+m(f.value),1),l(k,{percentage:g.value,status:"success"},null,8,["percentage"]),r("p",ct," 当前速度："+m(v.value),1)])]),h.value.length>0?(t(),o("div",it,[(t(!0),o(p,null,_(h.value,((e,a)=>(t(),o("div",rt,[l(x,{class:"card","body-style":{padding:"5px 10px"}},{default:i((()=>[ut,r("div",dt,[r("span",mt,m(e.Key),1),r("div",pt,[r("time",ft,m(Math.round(e.Size/1024))+"kb",1),l(d,{type:"text",class:"button",onClick:t=>C(`${e.Key}`)},{default:i((()=>[gt])),_:2},1032,["onClick"])])])])),_:2},1024)])))),256))])):(t(),o("div",vt," 暂时没有文件 "))])):(t(),o("div",yt,wt))])}}})},{path:"/setting",component:Qe}],ht=S({history:T(),routes:bt});const kt=P({state:{collspace:"false"!=localStorage.getItem("collspace"),token:localStorage.getItem("token")||"",uid:parseInt(localStorage.getItem("uid"))||-1},mutations:{changeCollspace(e,t){localStorage.setItem("collspace",t),e.collspace=t},setToken(e,t){localStorage.setItem("token",t),e.token=t},setUid(e,t){localStorage.setItem("uid",t),e.uid=t}}}),_t=O(U);_t.use(kt),_t.use(ht),_t.use(z),_t.mount("#app");
